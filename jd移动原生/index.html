<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet/less" href="less/index.less">
    <script src="./lib/less/less.js"></script>
</head>

<body>
    <div class="container">
        <header>
            <div class="search clearfix">
                <div class="logo"></div>
                <form action="">
                    <input type="search">
                </form>
                <div class="login">登陆</div>
            </div>
        </header>
        <section class="slide">
            <div class="slidebody clearfix">
                <div class="item">
                    <a href="#">
                        <img src="./images/l8.jpg" alt="">
                    </a>
                </div>
                <div class="item">
                    <a href="#">
                        <img src="./images/l1.jpg" alt="">
                    </a>
                </div>
                <div class="item">
                    <a href="#">
                        <img src="./images/l2.jpg" alt="">
                    </a>
                </div>
                <div class="item">
                    <a href="#">
                        <img src="./images/l3.jpg" alt="">
                    </a>
                </div>
                <div class="item">
                    <a href="#">
                        <img src="./images/l4.jpg" alt="">
                    </a>
                </div>
                <div class="item">
                    <a href="#">
                        <img src="./images/l5.jpg" alt="">
                    </a>
                </div>
                <div class="item">
                    <a href="#">
                        <img src="./images/l6.jpg" alt="">
                    </a>
                </div>
                <div class="item">
                    <a href="#">
                        <img src="./images/l7.jpg" alt="">
                    </a>
                </div>
                <div class="item">
                    <a href="#">
                        <img src="./images/l8.jpg" alt="">
                    </a>
                </div>
                <div class="item">
                    <a href="#">
                        <img src="./images/l1.jpg" alt="">
                    </a>
                </div>
            </div>
            <ol class="points clearfix">
                <li>
                    <a href="#" class="active"></a>
                </li>
                <li>
                    <a href="#"></a>
                </li>
                <li>
                    <a href="#"></a>
                </li>
                <li>
                    <a href="#"></a>
                </li>
                <li>
                    <a href="#"></a>
                </li>
                <li>
                    <a href="#"></a>
                </li>
                <li>
                    <a href="#"></a>
                </li>
                <li>
                    <a href="#"></a>
                </li>
            </ol>
        </section>

        <nav class="categray">
            <ul class="clearfix">
                <li>
                    <a href="">
                        <img src="./images/nav0.png" alt="">
                        <p>分类查询</p>
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="./images/nav1.png" alt="">
                        <p>分类查询</p>
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="./images/nav2.png" alt="">
                        <p>分类查询</p>
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="./images/nav3.png" alt="">
                        <p>分类查询</p>
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="./images/nav4.png" alt="">
                        <p>分类查询</p>
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="./images/nav5.png" alt="">
                        <p>分类查询</p>
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="./images/nav6.png" alt="">
                        <p>分类查询</p>
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="./images/nav6.png" alt="">
                        <p>分类查询</p>
                    </a>
                </li>
            </ul>
        </nav>

        <section class="seckill">
            <div class="seckill-topbar clearfix">
                <div class="naoz pull-left">
                    <img src="./images/seckill-icon.png" alt="">
                </div>
                <h4 class="seckill-title pull-left">掌上秒杀</h4>
                <ul class="pull-left">
                    <li>0</li>
                    <li>0</li>
                    <li>:</li>
                    <li>0</li>
                    <li>0</li>
                    <li>:</li>
                    <li>0</li>
                    <li>0</li>
                </ul>
                <a href="#" class="pull-right">更多</a>
            </div>
            <div class="product">
                <ul class="clearfix">
                    <li>
                        <a href="#">
                            <img src="./images/detail01.jpg" alt="">
                            <p>￥10.00</p>
                            <p>￥100.00</p>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <img src="./images/detail01.jpg" alt="">
                            <p>￥10.00</p>
                            <p>￥100.00</p>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <img src="./images/detail01.jpg" alt="">
                            <p>￥10.00</p>
                            <p>￥100.00</p>
                        </a>
                    </li>
                </ul>
            </div>
        </section>
        <section class="market" style="height:500px">
            <div class="topbar">
                <h3>京东超市</h3>
            </div>
            <div class="product clearfix">
                <div class="left pull-left  br">
                    <a href="#">
                        <img src="./images/cp1.jpg" alt="">
                    </a>
                </div>
                <div class="right pull-right">
                    <a href="" class="bb">
                        <img src="./images/cp2.jpg" alt="">
                    </a>
                    <a href="">
                        <img src="./images/cp3.jpg" alt="">
                    </a>
                </div>
            </div>
        </section>
    </div>

    <script>
        window.addEventListener("load", function () {
            searchtop();
            slider();
            timedown();
        });

        function searchtop() {
            var height = document.querySelector(".slide").offsetHeight;
            var header = document.querySelector(".search");
            window.addEventListener("scroll", function () {
                var scrolltop = document.documentElement.scrollTop || document.body.scrollTop;
                console.log(scrolltop);
                var opacity = 0;

                if (scrolltop < height) {
                    opacity = scrolltop / height;
                } else {
                    opacity = 1;
                }
                header.style.background = 'rgba(255,0,0,' + opacity + ')';
            });
        }

        //倒计时
        function timedown() {
            var ftime = new Date(2017, 10, 17, 15, 0, 0).getTime();
            var currenttime = new Date().getTime();
            var time = (ftime - currenttime) / 1000;
            var seckill = document.querySelectorAll(".seckill-topbar ul li");
            if (time <= 0) {
                clearInterval(timer);
            }
            var timer = setInterval(function () {
                time--;
                hour = Math.floor(time / 3600);
                min = Math.floor(time % 3600 / 60);
                sec = Math.floor(time % 60);
                seckill[0].innerHTML = Math.floor(hour / 10);
                seckill[1].innerHTML = hour % 10;
                seckill[3].innerHTML = Math.floor(min / 10);
                seckill[4].innerHTML = min % 10;
                seckill[6].innerHTML = Math.floor(sec / 10);
                seckill[7].innerHTML = sec % 10;
            }, 1000);
        }

        function slider() {
            var slideWidth = document.querySelector(".slide").offsetWidth;
            var slideSwipper = document.querySelector(".slidebody");
            var items = document.querySelectorAll(".slide .item");
            var index = 1;
            var timer = null;
            var points = document.querySelectorAll(".points a");
            var length = points.length;
            var istransitionEnd = true;
            starttimer();
            //小圆点
            function starttimer(){
                timer = setInterval(function () {
                   index++;
                   slideSwipper.style.transform = 'translateX(-' + index * slideWidth + 'px)';
                   slideSwipper.style.transition = "all 0.3s";
                   istransitionEnd = false;
                }, 1000);
            }
           
            slideSwipper.addEventListener("transitionend", function () {
                istransitionEnd = true;
                if(index >= 9 || index <= 0 ){
                    index >=9 ? index =1 : index = 8;
                slideSwipper.style.transform = 'translateX(-' + index * slideWidth + 'px)';
                slideSwipper.style.transition = "none";
                }
                  for(var i= 0; i < length; i++){
                        points[i].classList.remove("active");
                    }
                    points[index-1].classList.add("active");
                  
            });
            var startX = moveX = distanceX = 0;
            slideSwipper.addEventListener("touchstart", function (e) {
                startX = e.touches[0].clientX;
                clearInterval(timer);
            });
            slideSwipper.addEventListener("touchmove", function (e) {
                if(istransitionEnd == true){
                    moveX = e.touches[0].clientX;
                    distanceX = moveX - startX;
                    slideSwipper.style.transform = 'translateX(' + (-index * slideWidth + distanceX) + 'px)';
                    slideSwipper.style.transition = "none";
                }
               
            });

            slideSwipper.addEventListener("touchend", function (e) {
                if (Math.abs(distanceX) > slideWidth/3) {
                    distanceX > 0 ? index--:(distanceX<0?index++:index);
                } 
                slideSwipper.style.transform = 'translateX(' + (-index * slideWidth) + 'px)';
                slideSwipper.style.transition = "all 0.3s";
                starttimer();
                startX = moveX = distanceX = 0;
                istransitionEnd = false;
            });
        }
    </script>
</body>

</html>